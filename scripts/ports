#!/usr/bin/env python3

import sys

# https://isc.sans.edu/services.html

portlist = {
    0 : "Port 0: TCP, UDP - Reserved; do not use (but is a permissible source port value if the sending process does not expect messages in response",
    1 : "Port 1: TCP, UDP - TCPMUX (TCP Port Service Multiplexer [rfc-1078])",
    2 : "Port 2: TCP - compressnet Management Utility. Port 2 is not typically used.",
    3 : "Port 3: TCP, UDP - compressnet Compression Process",
    5 : "Port 5: TCP, UDP - RJE (Remote Job Entry)",
    7 : "Port 7: TCP, UDP - ECHO protocol",
    9 : "Port 9: TCP, UDP - DISCARD protocol",
    11 : "Port 11: TCP, UDP - SYSTAT protocol",
    13 : "Port 13: TCP, UDP - DAYTIME protocol",
    17 : "Port 17: TCP, UDP - QOTD (Quote of the Day) protocol",
    18 : "Port 18: TCP, UDP - Message Send Protocol",
    19 : "Port 19: TCP, UDP - CHARGEN (Character Generator) protocol",
    20 : "Port 20: TCP - FTP - data port (FTP-d)",
    21 : "Port 21: TCP - FTP - control (command) port (FTP-c)",
    22 : "Port 22: TCP, UDP - SSH (Secure Shell) - used for secure logins, file transfers (scp, sftp), port forwarding",
    23 : "Port 23: TCP, UDP - Telnet protocol - unencrypted text communications",
    25 : "Port 25: TCP, UDP - SMTP (Simple Mail Transport Protocol) - used for e-mail routing between mailservers",
    26 : "Port 26: TCP, UDP - RSFTP - A simple FTP-like protocol",
    35 : "Port 35: TCP, UDP - QMS Magicolor 2 printer",
    37 : "Port 37: TCP, UDP - TIME protocol",
    38 : "Port 38: TCP, UDP - Route Access Protocol",
    39 : "Port 39: TCP, UDP - Resource Location Protocol",
    41 : "Port 41: TCP, UDP - Graphics",
    42 : "Port 42: TCP, UDP - Host Name Server",
    43 : "Port 43: TCP - WHOIS protocol",
    49 : "Port 49: TCP, UDP - TACACS Login Host protocol",
    53 : "Port 53: TCP, UDP - DNS (Domain Name System)",
    57 : "Port 57: TCP - MTP, Mail Transfer Protocol",
    67 : "Port 67: UDP - BOOTP (BootStrap Protocol) server; also used by DHCP (Dynamic Host Configuration Protocol)",
    68 : "Port 68: UDP - BOOTP client; also used by DHCP",
    69 : "Port 69: UDP - TFTP (Trivial File Transfer Protocol)",
    70 : "Port 70: TCP - Gopher protocol",
    79 : "Port 79: TCP - Finger protocol",
    80 : "Port 80: TCP - HTTP (HyperText Transfer Protocol)",
    81 : "Port 81: TCP - Torpark - Onion routing ORport",
    82 : "Port 82: UDP - Torpark - Control Port",
    88 : "Port 88: TCP - Kerberos - authenticating agent",
    101: "Port 101: TCP	- HOSTNAME",
    102: "Port 102: TCP - ISO-TSAP protocol",
    107: "Port 107: TCP - Remote Telnet Service",
    109: "Port 109: TCP - POP (Post Office Protocol, version 2)",
    110: "Port 110: TCP - POP3 (Post Office Protocol, version 3)",
    111: "Port 111: TCP, UDP - SUNRPC protocol",
    113: "Port 113: TCP	- ident - old server identification system, still used by IRC servers to identify its users",
    115: "Port 115: TCP - SFTP, Simple File Transfer Protocol",
    117: "Port 117: TCP - UUCP-PATH",
    118: "Port 118: TCP, UDP - SQL Services",
    119: "Port 119: TCP - NNTP (Network News Transfer Protocol)",
    123: "Port 123: UDP	NTP (Network Time Protocol)",
    135: "Port 135: TCP, UDP - EPMAP / Microsoft RPC Locator Service",
    137: "Port 137: TCP, UDP - NetBIOS Name Service",
    138: "Port 138: TCP, UDP - NetBIOS NetBIOS Datagram Service",
    139: "Port 139: TCP, UDP - NetBIOS NetBIOS Session Service",
    143: "Port 143: TCP, UDP - IMAP4 (Internet Message Access Protocol 4)",
    152: "Port 152: TCP, UDP - BFTP, Background File Transfer Program",
    153: "Port 153: TCP, UDP - SGMP, Simple Gateway Monitoring Protocol",
    156: "Port 156: TCP, UDP - SQL Service",
    158: "Port 158: TCP, UDP - DMSP, Distributed Mail Service Protocol",
    161: "Port 161: TCP, UDP - SNMP (Simple Network Management Protocol)",
    162: "Port 162: TCP, UDP - SNMPTRAP",
    170: "Port 170: TCP - Print-srv",
    179: "Port 179: TCP - BGP (Border Gateway Protocol)",
    194: "Port 194: TCP - IRC (Internet Relay Chat)",
    201: "Port 201: TCP, UDP - AppleTalk Routing Maintenance",
    209: "Port 209: TCP, UDP - The Quick Mail Transfer Protocol",
    213: "Port 213: TCP, UDP - IPX",
    218: "Port 218: TCP, UDP - MPP, Message Posting Protocol",
    220: "Port 220: TCP, UDP - IMAP, Interactive Mail Access Protocol, version 3",
    259: "Port 259: TCP, UDP - ESRO, Efficient Short Remote Operations",
    264: "Port 264: TCP, UDP - BGMP, Border Gateway Multicast Protocol",
    311: "Port 311: TCP - Apple Server-Admin-Tool, Workgroup-Manager-Tool",
    318: "Port 318: TCP, UDP - TSP, Time Stamp Protocol",
    323: "Port 323: TCP, UDP - IMMP, Internet Message Mapping Protocol",
    383: "Port 383: TCP, UDP - HP OpenView HTTPs Operations Agent",
    366: "Port 366: TCP, UDP - SMTP, Simple Mail Transfer Protocol. ODMR, On-Demand Mail Relay",
    369: "Port 369: TCP, UDP - Rpc2portmap",
    371: "Port 371: TCP, UDP - ClearCase albd",
    384: "Port 384: TCP, UDP - A Remote Network Server System",
    387: "Port 387: TCP, UDP - AURP, AppleTalk Update-based Routing Protocol",
    389: "Port 389: TCP, UDP - LDAP (Lightweight Directory Access Protocol)",
    401: "Port 401: TCP, UDP - UPS Uninterruptible Power Supply",
    411: "Port 411: TCP - Direct Connect Hub port",
    427: "Port 427: TCP, UDP - SLP (Service Location Protocol)",
    443: "Port 443: TCP - HTTPS",
    444: "Port 444: TCP, UDP - SNPP, Simple Network Paging Protocol",
    445: "Port 445: TCP - Microsoft-DS (Active Directory, Windows shares, Sasser worm, Agobot, Zobotworm)",
    445: "Port 445: UDP - Microsoft-DS SMB file sharing",
    464: "Port 464: TCP, UDP - Kerberos Change/Set password",
    465: "Port 465: TCP	- SMTP over SSL - CONFLICT with registered Cisco protocol",
    500: "Port 500: TCP, UDP - ISAKMP, IKE-Internet Key Exchange",
    512: "Port 512: TCP - exec, Remote Process Execution",
    512: "Port 512: UDP - comsat, together with biff: notifies users of new c.q. yet unread e-mail",
    513: "Port 513: TCP	- Login",
    513: "Port 513: UDP	- Who",
    514: "Port 514: TCP	- rsh protocol - used to execute non-interactive commandline commands on a remote system and see the screen return",
    514: "Port 514: UDP - syslog protocol",
    515: "Port 515: TCP	- Line Printer Daemon protocol - used in LPD printer servers",
    517: "Port 517: TCP - Talk",
    518: "Port 518: UDP	- NTalk",
    520: "Port 520: TCP	- efs",
    520: "Port 520: UDP - Routing - RIP",
    513: "Port 513: UDP - Router",
    524: "Port 524: TCP, UDP - NCP (NetWare Core Protocol) is used for a variety things such as access to primary NetWare server resources, Time Synchronization, etc.",
    525: "Port 525: UDP - Timed, Timeserver",
    530: "Port 530: TCP, UDP - RPC",
    531: "Port 531: TCP, UDP - AOL Instant Messenger, IRC",
    532: "Port 532: TCP - netnews",
    533: "Port 533: UDP - netwall, For Emergency Broadcasts",
    540: "Port 540: TCP - UUCP (Unix-to-Unix Copy Protocol)",
    542: "Port 542: TCP, UDP - commerce (Commerce Applications)",
    543: "Port 543: TCP - klogin, Kerberos login",
    544: "Port 544: TCP	- kshell, Kerberos Remote shell",
    546: "Port 546: TCP, UDP - DHCPv6 client",
    547: "Port 547: TCP, UDP - DHCPv6 server",
    548: "Port 548: TCP - AFP (Apple Filing Protocol)",
    550: "Port 550: UDP	- new-rwho, new-who",
    554: "Port 554: TCP, UDP - RTSP (Real Time Streaming Protocol)",
    556: "Port 556: TCP - Remotefs, rfs, rfs_server",
    560: "Port 560: UDP - rmonitor, Remote Monitor",
    561: "Port 561: UDP	- monitor",
    563: "Port 563: TCP, UDP - NNTP protocol over TLS/SSL (NNTPS)",
    587: "Port 587: TCP	- Email message submission (SMTP) (RFC 2476)",
    591: "Port 591: TCP - FileMaker 6.0 Web Sharing (HTTP Alternate, see port 80)",
    593: "Port 593: TCP, UDP - HTTP RPC Ep Map",
    604: "Port 604: TCP	TUNNEL",
    631: "Port 631: TCP, UDP - IPP, Internet Printing Protocol",
    636: "Port 636: TCP, UDP - LDAP over SSL (encrypted transmission)",
    639: "Port 639: TCP, UDP - MSDP, Multicast Source Discovery Protocol",
    646: "Port 646: TCP - LDP, Label Distribution Protocol",
    647: "Port 647: TCP - DHCP Failover Protocol",
    648: "Port 648: TCP - RRP, Registry Registrar Protocol",
    652: "Port 652: TCP - DTCP, Dynamic Tunnel Configuration Protocol",
    654: "Port 654: TCP - AODV, Ad hoc On-Demand Distance Vector",
    665: "Port 665: TCP - sun-dr, Remote Dynamic Reconfiguration",
    666: "Port 666: UDP	- Doom, First online FPS",
    674: "Port 674: TCP - ACAP, Application Configuration Access Protocol",
    691: "Port 691: TCP - MS Exchange Routing",
    692: "Port 692: TCP - Hyperwave-ISP",
    695: "Port 695: TCP - IEEE-MMS-SSL",
    698: "Port 698: TCP	- OLSR, Optimized Link State Routing",
    699: "Port 699: TCP	- Access Network",
    700: "Port 700: TCP	- EPP, Extensible Provisioning Protocol",
    701: "Port 701: TCP - LMP, Link Management Protocol",
    702: "Port 702: TCP	- IRIS over BEEP",
    706: "Port 706: TCP - SILC, Secure Internet Live Conferencing",
    711: "Port 711: TCP - TDP, Tag Distribution Protocol",
    712: "Port 712: TCP - TBRPF, Topology Broadcast based on Reverse-Path Forwarding",
    720: "Port 720: TCP - SMQP, Simple Message Queue Protocol",
    749: "Port 749: TCP, UDP - kerberos-adm, Kerberos administration",
    750: "Port 750: UDP	- Kerberos version IV",
    782: "Port 782: TCP - Conserver serial-console management server",
    829: "Port 829: TCP - CMP (Certificate Management Protocol)",
    860: "Port 860: TCP - iSCSI",
    873: "Port 873: TCP - rsync File synchronisation protocol",
    901: "Port 901: TCP - Samba Web Administration Tool (SWAT)",
    902: "Port 902: TCP - VMware Server Console",
    911: "Port 911: TCP - Network Console on Acid (NCA) - local tty redirection over OpenSSH",
    981: "Port 981: TCP - SofaWare Technologies Remote HTTPS management for firewall devices running embedded Checkpoint Firewall-1 software",
    989: "Port 989: TCP, UDP - FTP Protocol (data) over TLS/SSL",
    990: "Port 990: TCP, UDP - FTP Protocol (control) over TLS/SSL",
    991: "Port 991: TCP, UDP - NAS (Netnews Admin System)",
    992: "Port 992: TCP, UDP - Telnet protocol over TLS/SSL",
    993: "Port 993: TCP - IMAP4 over SSL (encrypted transmission)",
    995: "Port 995: TCP - POP3 over SSL (encrypted transmission)",
    3389: "Port 3389: TCP - RDP"
}

def lookup(port):
    returnedresults = False
    if port.isdigit():
        for a, b in portlist.items():
            if a == int(port):
                print (b)
                returnedresults = True
        if not returnedresults:
            print("No entry for that port")
    else:
        print("Not a valid port")

if __name__ == "__main__":

    if len(sys.argv) == 1:
        print("Usage: port <port_number>\n")
        print("0     to 1023  - Well-Known Ports (ssh, ftp, etc)")
        print("1024  to 49151 - Registered Ports for Software Applications")
        print("49152 to 65535 - Public Ports\n")

    if len(sys.argv) > 1:
        for argv in sys.argv[1:]:
            lookup(argv)

"""
Add a reverse search using https://www.speedguide.net/ports.php?filter=vmware
"""

